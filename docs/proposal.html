<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Team Janíce">
<meta name="dcterms.date" content="2023-11-06">

<title>janIce - Proposal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">janIce</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./presentation.html" rel="" target="">
 <span class="menu-text">Presentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./proposal.html" rel="" target="" aria-current="page">
 <span class="menu-text">Proposal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sta113-f23/project-2-janIce" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Proposal</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Team Janíce </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview:</h2>
<p>In this project, we seek to identify both community-level sociodemographic factors and state-level funding factors that predict statewide fourth-grade achievement rates in reading. Our ultimate goal is to determine pathways for policy-based intervention in the future to maximize educational success for youth of all backgrounds. We came upon this topic as a result of the content we are learning in our FOCUS cluster, Knowledge in the Service of Society. We are seeking to go beyond identifying community-level inequities and instead hope to investigate root causes and their logical solutions.&nbsp;</p>
<p>To properly explore these factors, our project will include four major steps:</p>
<p>First, we will teach ourselves how to use the “maps” package to create a choropleth map of the United States where a gradient scale demonstrates the state achievement rates in fourth grade reading. This visualization will allow us, and others, to easily identify the states with highest achievement rates. From here, we can conduct further analysis on the funding distributions and community-level variables in these “best-practice states.”&nbsp;</p>
<p>Second, we will make a second choropleth map using the “expenditures” dataset. This visualization will serve as a comparison to the first one, providing a visual representation of total school expenditures in elementary schools by state. By creating two maps of the same area (the United States) and using gradient scales to indicate both funding levels and achievement scores, viewers will be able to easily draw their own conclusions about possible associations between the two factors. In later parts of our project, we will use models to come to objective standpoints.&nbsp;</p>
<p>Third, we will use forward selection to identify community-level factors (e.g.&nbsp;poverty rate, median household income, average cost of childcare) that accurately predict statewide fourth grade achievement rates in reading. We will select potential predictors based on background knowledge from our other FOCUS classes and then move to statistical methods (adjusted-R2) to assess their importance in this context. Ultimately, we will have a linear regression model that merges a collection of community-level socioeconomic variables to predict fourth grade reading levels. After identifying which sociodemographic changes impact education achievement, we will be able to later theorize over possible steps to progress towards overall improvement via these specific pathways.</p>
<p>The fourth goal we want to accomplish is largely based upon the initial visualizations we create. Using the choropleth map, regression model, and R2 analysis, we will ideally identify one or two noteworthy variables that appear to be the best predictors of achievement in fourth graders. We will complete 1-3 of these three options based on initial findings.&nbsp;</p>
<ul>
<li><p>If we see that total elementary school expenditures seems to predict achievement rate based on the choropleth map from goal #2, we will analytically confirm this relationship through linear regression. We will then use the “mutate” function to see whether the relationship is maintained based on the percentage of total state funding that is spent in elementary schools or whether an association exclusively exists between the total amount of elementary school funding and achievement rates.&nbsp;</p></li>
<li><p>Based on knowledge from our other KISS classes, we will explore the interactive effect between two significant community-level predictors of achievement rates to get a more granular understanding of how community structures combine with one another to predict academic success in youth.&nbsp;</p></li>
<li><p>We will determine a threshold for “high achievement rates” and then subset our data to include states with achievement rates past this threshold. For these states, we will create bar charts that allow us to examine the distribution of funding in every sector within total state expenditures.&nbsp;</p>
<ul>
<li>We will use these bar charts to determine which sectors (e.g.&nbsp;transportation, Medicaid, etc.) seem to be getting the greatest allocation of state funding in top achievement states and then use multiple linear regression to confirm our hypothesized associations between funding distribution and achievement outcomes.</li>
</ul></li>
</ul>
</section>
<section id="loading-and-exploring-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-and-exploring-data">Loading and Exploring Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#loading datasets childcare_costs and counties from tidytuesday</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>counties <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/counties.csv'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#loading dataset expenditures from tidytuesday</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>kids <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-15/kids.csv'</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#loading dataset scores</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/scores.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Expenditures dataset is based on the tidytuesday dataset US Spending on Kids and provides an extensive accounting of public spending on children from 1997 through 2016. We chose this dataset because we wanted to track and compare government spending by state and throughout the years, and see how this affects statewide education improvement. This dataset utilizes various federal resources such as the US Census Bureau’s Annual Survey of State and Local Government Finances to illustrate individual state spending on education, health, income security, and other areas. The Expenditures dataset has 23460 observations and 6 variables. The observations are separated by state (plus the District of Columbia) and details 23 different types of public spending including elementary &amp; secondary education, pell grants, social security payments on children, and unemployment compensation benefits. The dataset also captures the raw amount spent and the total and per child amounts in 2016 dollars for each year spent.</p>
<p>The Scores dataset is based on the Nation’s Report Card data that uses the 2022 National Assessment of Educational Progress (NAEP) assessments with scores from 0-500 in mathematics, reading, writing, and sciences at grade 4. This dataset compares state and jurisdiction performance to the national public average scale score of 216. We chose this dataset because we need a quantitative way to analyze educational progress within each state/jurisdiction. The Scores dataset has 54 observations and 6 variables. The observations are separated by state (plus the Department of Defense Education Activity, National Public, District of Columbia, and Puerto Rico). The dataset displays the average scores for each region, the difference from the National Public, how significant the score is from the National Public, the percentage at or above Basic, and the percentage at or above Proficient.</p>
<p>The C</p>
</section>
<section id="weekly-timeline" class="level2">
<h2 class="anchored" data-anchor-id="weekly-timeline">Weekly Timeline:</h2>
<p>Week #3 (part 1—before 11/7)&nbsp;</p>
<ul>
<li><p>Finalize write-up of high-level goal #4 - Nush&nbsp;</p></li>
<li><p>Create this “plan of attack” - Nush&nbsp;</p></li>
<li><p>Finish exploring the datasets - Alan and Noah&nbsp;</p>
<ul>
<li><p>Determine the # of observations and variables (using inline code) in each dataset</p></li>
<li><p>Identify and define the relevant variables in each dataset (using inline code)&nbsp;</p></li>
<li><p>Load all datasets into the project repository (3)&nbsp;</p></li>
</ul></li>
<li><p>Finalize the organization of our project repository - Julia&nbsp;</p>
<ul>
<li><p>Create appropriate folders in the project repository with appropriate README.md files&nbsp;</p></li>
<li><p>Add/fix inline code in the proposal&nbsp;</p></li>
<li><p>Update the data dictionary&nbsp;</p></li>
</ul></li>
<li><p>Asynchronous discussion to assign each of the outlined responsibilities to various team members&nbsp;</p></li>
<li><p>Upload a draft of the proposal into official project repository - Nush&nbsp;</p></li>
</ul>
<p>Week #3 (part 2—after 11/7)&nbsp;</p>
<ul>
<li>Team meeting to make adjustments to our proposal following peer review&nbsp;</li>
</ul>
<p>Week #4&nbsp;</p>
<ul>
<li><p>Merge the “expenditures” dataset with “scores” dataset - Noah&nbsp;</p></li>
<li><p>Merge the “childcarecosts” dataset with “scores” dataset - Noah</p></li>
<li><p>Adapt all datasets to only include variables of interest - Noah&nbsp;</p></li>
<li><p>Read through the description of&nbsp; the “maps” package in R - Julia and Alan&nbsp;</p>
<ul>
<li>Work collaboratively to create two choropleth maps through the functions in the “maps” package (visualizations #1 and #2)&nbsp;</li>
</ul></li>
<li><p>Use forward selection to build a multiple linear regression model as outlined in goal #3 and document the process (including adjusted R2 values) - Nush&nbsp;</p></li>
</ul>
<p>Week #5&nbsp;</p>
<ul>
<li><p>Team meeting:&nbsp;</p>
<ul>
<li><p>Review feedback on proposal and make adjustments to our goals accordingly&nbsp;</p></li>
<li><p>Select which of the options from goal #4 to pursue&nbsp;</p></li>
<li><p>Create a mini-timeline for the rest of the week to asynchronously achieve our finalized goal #4&nbsp;&nbsp;</p></li>
</ul></li>
<li><p>Finish goal #4 as planned at team meeting&nbsp;</p></li>
</ul>
<p>Week #6:&nbsp;</p>
<ul>
<li><p>Interpret findings and create a draft of write-up</p>
<ul>
<li><p>Introduction - rationale for project and how it holistically connects to KISS - Noah</p></li>
<li><p>Summary of goals and process - Noah</p></li>
<li><p>Findings from visualization #1 (use inline code) - Alan&nbsp;</p></li>
<li><p>Findings from visualization #2 (use inline code) - Alan&nbsp;</p></li>
<li><p>Findings for visualization #3 (use inline code) - Alan</p></li>
<li><p>Narrative for how we chose to approach goal #4 - Nush&nbsp;</p></li>
<li><p>Findings from visualization(s) #4 (use inline code) - Nush&nbsp;</p></li>
<li><p>Applications and recommendations for further research - Julia&nbsp;</p></li>
<li><p>Limitations - Julia/Noah (depending on how long the other steps take)&nbsp;</p></li>
</ul></li>
</ul>
<p>Week #7:&nbsp;</p>
<ul>
<li><p>Team meeting #1:&nbsp;</p>
<ul>
<li><p>Finalize write-up together&nbsp;</p></li>
<li><p>Use write-up as an outline to design presentation&nbsp;</p></li>
<li><p>Make adjustments to all parts of the project according to peer review</p></li>
</ul></li>
<li><p>Team meeting #2:&nbsp;</p>
<ul>
<li>Practice and refine presentation</li>
</ul></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>