---
output: html_document
editor_options: 
  chunk_output_type: console
editor: 
  markdown: 
    wrap: 72
---

# Loading Packages and Data

```{r}
#| label: loading-packages
#| message: false 

library(tidyverse)
library(tidymodels)
library(maps)
library(leaps)
library(dplyr)
library(scales)
```

```{r}
#| label: loading-datasets
#| message: false

#loading datasets childcare_costs and counties from tidytuesday

#loading dataset childcare_costs
childcare_costs <- read_csv("data/childcare_costs.csv")

#loading dataset counties
counties <- read_csv("data/counties.csv")

#loading dataset expenditures
expenditures <- read_csv("data/kids.csv")

#loading dataset scores
scores <- read_csv("data/scores.csv")

#loading us map 
us_states <- map_data("state")
```

# Choropleth Maps

Code for us_states from Kieran Healy:
`https://socviz.co/maps.html#map-u.s.-state-level-data`

```{r}
#| label: us-map-dataset

expenditures_PK12ed <- expenditures |> 
  mutate(region = str_to_lower(state)) |>
  filter(variable == "PK12ed")

us_states_expenditures <- us_states |>
  select(-subregion) |>
  inner_join(expenditures_PK12ed, join_by(region == region), relationship = "many-to-many") |> 
  filter(region != "district of columbia") |> 
  filter(year == 2016)
```

```{r}
#| label: us-map-expenditures 
#| fig.alt: "This visualization is a choropleth map of the United States, a plot that indicates the strength of a certain variable across different states by increasing or decreasing their shading (excluding Hawaii and Alaska). This plot has the title 'Expenditures Based on State' and is mapping 2016 state expenditures on education per child, adjusted for inflation, into each state. From this visualization, we see that states in the Northeast, namely New York, New Jersey, and Vermont, appear to provide the most funding to their students (at around $13,000). We can also see that states in the South and West, specifically New Mexico, Idaho, and Utah, have the lowest expenditure per child (at around $2,500). Most of the Midwest appears to have average per child expenditures, but Wyoming stands out as having significantly greater amounts allotted towards this."

ggplot(us_states_expenditures, aes(x = long, y = lat, group = group, fill = inf_adj_perchild)) +
  geom_polygon() +
  theme_void() +
  theme(legend.position = c(.2, .1),
        legend.direction = "horizontal") + 
  scale_fill_gradient(low = "gray90", high = "darkblue") +
  coord_quickmap() + 
  labs(title = "Expenditures Based on State", 
       fill = "Expenditure \nper Child \n(in thousands)")
```

```{r}
#| label: us-map-scores
#| fig.alt: "This visualization is a choropleth map of the United States, a plot that indicates the strength of a certain variable across different states by increasing or decreasing their shading (excluding Hawaii and Alaska). This plot has the title 'Achievement Rates Based on State' and is mapping 2016 4th-grade reading achievement rates from 2022 to each state. From this visualization, we see that there does not appear to be a clear pattern in higher achievement rates--Massachusetts, New Jersey, and Florida seem to be the highest achieving states at around 225 while New Mexico and West Virginia appear to be the lowest achieving ones (at around 200). The states of Wyoming, Utah, and Colorado are also high-achieving (with scores of about 225, similarly to Massachusetts) among many other average- or low-achieving states."

scores_new <- scores |> 
  mutate(region = str_to_lower(Jurisdiction), MN = as.numeric(MN))

us_states_scores <- us_states |>
  select(-subregion) |>
  inner_join(scores_new, join_by(region == region), relationship = "many-to-many")

ggplot(us_states_scores, aes(x = long, y = lat, group = group, fill = MN)) +
  geom_polygon() + 
  theme_void() + 
  scale_fill_gradient(low = "gray90", high = "darkblue") +
  theme(legend.position = c(.2, .1),
        legend.direction = "horizontal", 
        ) +
  coord_quickmap() + 
  labs(title = "Achievement Rates Based on State", 
       fill = "Average 4th Grade \nReading Score")
```

# Merging Data

```{r}
#| label: merging-data 

#Merging childcare_costs and counties 
merged_counties_data <- left_join(childcare_costs, counties, join_by("county_fips_code"))

#Preparing scores to merge
renamed_scores <- scores |> 
  rename("state_name" = "Jurisdiction")

#Merging all data
merged_data <- left_join(merged_counties_data, renamed_scores, join_by("state_name"))

```

# Forward Selection Approach to Linear Regression Model for Predictors of 4th Grade Reading Levels

**Literature Review:** What factors are most important in predicting
elementary academic achievement levels?

<https://portal.ct.gov/-/media/SDE/ESSA-Evidence-Guides/Early_Skills_and_Predictors_of_Academic_Success#:~:text=Behavioral%20skills%20have%20been%20found,behavioral%20skills%20are%20developing%20appropriately.>

-   Behavioral skills, are influenced by parental monitoring and family
    stability

    -   Self-regulation and social competence are two crucial behavioral
        skills that predict reading level

-   Language minority students demonstrated more weakness in oral
    comprehension and vocabulary

-   Students of both genders from high-poverty households performed
    significantly worse in alphabet knowledge, phonological awareness,
    and spelling

-   High levels of inhibitory control predicts better academic skills in
    Grade 1

-   Social problem-solving competence is a strong predictor of academic
    skills

<https://apa.org/pi/ses/resources/publications/education>

-   Low-SES families are less likely to have experiences that encourage
    the development of critical skills such as phonological awareness,
    vocabulary, and oral language

-   Reading competency is associated with number of books owned and
    parental distress

-   Teachers' years of experience and quality of training help predict
    children's academic achievements

-   There is a higher likelihood of children from lower-SES households
    displaying learning-related behavior problems

[https://hbr.org/2023/01/how-a-parents-experience-at-work-impacts-their-kids#:\~:text=A%20multi%2Dyear%20study%20following,by%20their%20parents'%20work%20lives.&text=It's%20no%20secret%20that%20our,our%20lives%20outside%20of%20work.](https://hbr.org/2023/01/how-a-parents-experience-at-work-impacts-their-kids#:~:text=A%20multi%2Dyear%20study%20following,by%20their%20parents'%20work%20lives.&text=It's%20no%20secret%20that%20our,our%20lives%20outside%20of%20work.)

-   A longitudinal study of 370+ working-class families finds that jobs
    that allow for more autonomy and more supportive supervisors were
    warmer and more engaged with their children

-   More intimate parenting styles are associated with early academic
    achievement in children

-   Anecdotal evidence indicates that when workers feel more trust and
    flexibility at work, they are more productive and better able to
    care for children

<https://cepa.stanford.edu/educational-opportunity-monitoring-project/achievement-gaps/race/>

-   A jarring achievement gap amongst students of varying races
    particularly between white, Black, and Hispanic children

    -   Likely mediated by differences in the socioeconomic statuses of
        families

<https://www.apa.org/news/press/releases/2023/06/quality-child-care-science-math#:~:text=Washington%20%E2%80%94%20Children%20who%20receive%20high,by%20the%20American%20Psychological%20Association.>

-   High-quality childcare has been rigorously shown to lead to better
    performance in science, technology, engineering, and math through
    high school

**Summarized review:** After a review of literature in the field of
early academic achievement, we find that various social, psychological,
and economic factors have been found to contribute to the development of
reading skills in elementary schoolers. Socioeconomic status has been
consistently shown to influence academic success, specifically due to
differing access to books, supportive services, and qualified teachers
as well as due to exposure to adversity and parental distress. The
structural connections between race, socioecnomic status, and long-term
outcomes makes racial minority status another potential variable of
interest. Along with socioeconomic status, parents' capacity to be
highly engaged and warm affects psychological health, which often
underpins academic trajectories. Thus, we seek to examine whether having
both, one, or no working parents affects reading skills. Finally, it is
necessary to explore the role of access to both family-based and
center-based child care given the proven significance of high-quality
child care.

Cross-referencing research with our data to identify potential factors
(most must be created using given variables):

-   Community poverty level

-   Percentage of community that belongs to minority racial status

-   Percent of single-family households

-   Percent of families where both parents work vs. where one parent
    works

-   Median cost of family-based childcare

-   Median cost of center-based childcare

```{r}
#| label: forward-selection-model-variables

#Family poverty level 
merged_data <- merged_data |>
  mutate(family_poverty = pr_f)

#Minority racial status 
merged_data <- merged_data |> 
  mutate(
    minority_racial_status = 
      one_race_b +
      one_race_i +
      one_race_a +
      one_race_h +
      one_race_other + 
      two_races
  )

#Percentage of single-mother households 
merged_data <- merged_data |> 
  mutate(
    percentage_single_mother =
      h_under6_single_m / households
  )
  
#Ratio of one-parent-working to two-parent-working households 
merged_data <- merged_data |> 
  mutate(
    one_parent_households = h_under6_f_work + h_under6_f_work, 
    ratio_of_one_to_both = one_parent_households / h_under6_both_work
  )

#Cost of center-based child care
merged_data <- merged_data |> 
  mutate(
    average_center_child_care = 
    (mc_infant + mc_toddler + mc_preschool)/3
  )

#Cost of family-based child care 
merged_data <- merged_data |> 
  mutate(
    average_family_child_care = 
    (mfcc_infant + mfcc_toddler + mfcc_preschool)/3
  )
```

# Conducting Forward Selection

```{r}
#| label: forward-selection-model 

#filtering by year 
merged_data_2018 <- merged_data |> 
  filter(study_year == "2018")

#Creating regression model with all possible variables 
merged_data_2018 <- merged_data_2018 |> 
  filter(!is.na(MN),
         !is.na(family_poverty),
         !is.na(percentage_single_mother),
         !is.na(ratio_of_one_to_both),
         !is.na(average_center_child_care),
         !is.na(average_family_child_care),
         !is.na(one_parent_households),
         ratio_of_one_to_both != 'Inf') |>
  mutate(
   MN = as.numeric(MN)) 

maximum_regression_model <- linear_reg() |>
  fit(
    MN ~ 
      family_poverty + 
      percentage_single_mother + 
      average_center_child_care + 
      average_family_child_care + 
      one_parent_households + 
      ratio_of_one_to_both, 
    data = merged_data_2018)

regression_model_1 <- linear_reg() |> 
  fit(MN ~ family_poverty, data = merged_data_2018)
```

```{r}
#| label: creating-all-regression-models

regression_model_1 <- lm(MN ~ family_poverty, data = merged_data_2018)

regression_model_2 <- lm(MN ~ percentage_single_mother, data = merged_data_2018)

regression_model_3 <- lm(MN ~ average_center_child_care, data = merged_data_2018)

regression_model_4 <- lm(MN ~ average_family_child_care, data = merged_data_2018)

regression_model_5 <- lm(MN ~ one_parent_households, data = merged_data_2018)

regression_model_6 <- lm(MN ~ ratio_of_one_to_both, data = merged_data_2018)

regression_model_7 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother, 
  data = merged_data_2018)

regression_model_8 <- lm(
  MN ~ 
    family_poverty + 
    average_center_child_care, 
  data = merged_data_2018)

regression_model_9 <- lm(
  MN ~ 
    family_poverty + 
    average_family_child_care, 
  data = merged_data_2018)

regression_model_10 <- lm(
  MN ~ 
    family_poverty + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_11 <- lm(
  MN ~ 
    family_poverty + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_12 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_center_child_care, 
  data = merged_data_2018)

regression_model_13 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_family_child_care, 
  data = merged_data_2018)

regression_model_14 <- lm(
  MN ~ 
    percentage_single_mother + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_15 <- lm(
  MN ~ 
    percentage_single_mother + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_16 <- lm(
  MN ~ 
    average_center_child_care + 
    average_family_child_care, 
  data = merged_data_2018)

regression_model_17 <- lm(
  MN ~ 
    average_center_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_18 <- lm(
  MN ~ 
    average_center_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_19 <- lm(
  MN ~ 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_20 <- lm(
  MN ~ 
    average_family_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_21 <- lm(
  MN ~ 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_22 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_center_child_care, 
  data = merged_data_2018)

regression_model_23 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_family_child_care, 
  data = merged_data_2018)

regression_model_24 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_25 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_26 <- lm(
  MN ~ 
    family_poverty + 
    average_center_child_care + 
    average_family_child_care, 
  data = merged_data_2018)

regression_model_27 <- lm(
  MN ~ 
    family_poverty + 
    average_center_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_28 <- lm(
  MN ~ 
    family_poverty + 
    average_center_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_29 <- lm(
  MN ~ 
    family_poverty +
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_30 <- lm(
  MN ~ 
    family_poverty + 
    average_family_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_31 <- lm(
  MN ~ 
    family_poverty + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_32 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_center_child_care + 
    average_family_child_care, 
  data = merged_data_2018)

regression_model_33 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_center_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_34 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_center_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_35 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_36 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_family_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_37 <- lm(
  MN ~ 
    percentage_single_mother + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_38 <- lm(
  MN ~ 
    average_center_child_care + 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_39 <- lm(
  MN ~ 
    average_center_child_care + 
    average_family_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_40 <- lm(
  MN ~ 
    average_center_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_41 <- lm(
  MN ~ 
    average_family_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_42 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_center_child_care + 
    average_family_child_care, 
  data = merged_data_2018)

regression_model_43 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_center_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_44 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_center_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_45 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_46 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_family_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_47 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_48 <- lm(
  MN ~ 
    family_poverty + 
    average_center_child_care + 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_49 <- lm(
  MN ~ 
    family_poverty + 
    average_center_child_care + 
    average_family_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_50 <- lm(
  MN ~ 
    family_poverty + 
    average_center_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_51 <- lm(
  MN ~ 
    family_poverty + 
    average_family_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_52 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_center_child_care + 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_53 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_center_child_care + 
    average_family_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_54 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_center_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_55 <- lm(
  MN ~ 
    percentage_single_mother + 
    average_family_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_56 <- lm(
  MN ~ 
    average_center_child_care + 
    average_family_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_57 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_center_child_care + 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_58 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_center_child_care + 
    average_family_child_care + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_59 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_center_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

regression_model_60 <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_family_child_care + 
    ratio_of_one_to_both + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_61 <- lm(
  MN ~ 
    family_poverty + 
    ratio_of_one_to_both + 
    average_center_child_care + 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

regression_model_62 <- lm(
  MN ~ 
    ratio_of_one_to_both + 
    percentage_single_mother + 
    average_center_child_care + 
    average_family_child_care + 
    one_parent_households, 
  data = merged_data_2018)

maximum_regression_model <- lm(
  MN ~ 
    family_poverty + 
    percentage_single_mother + 
    average_center_child_care + 
    average_family_child_care + 
    one_parent_households + 
    ratio_of_one_to_both, 
  data = merged_data_2018)

```

```{r}
#| label: creating-dataframe-analyzing-model

r_squared <- c(summary(regression_model_1)$adj.r.squared, 
          summary(regression_model_2)$adj.r.squared, 
          summary(regression_model_3)$adj.r.squared, 
          summary(regression_model_4)$adj.r.squared, 
          summary(regression_model_5)$adj.r.squared, 
          summary(regression_model_6)$adj.r.squared, 
          summary(regression_model_7)$adj.r.squared, 
          summary(regression_model_8)$adj.r.squared, 
          summary(regression_model_9)$adj.r.squared, 
          summary(regression_model_10)$adj.r.squared, 
          summary(regression_model_11)$adj.r.squared, 
          summary(regression_model_12)$adj.r.squared, 
          summary(regression_model_13)$adj.r.squared, 
          summary(regression_model_14)$adj.r.squared, 
          summary(regression_model_15)$adj.r.squared, 
          summary(regression_model_16)$adj.r.squared, 
          summary(regression_model_17)$adj.r.squared, 
          summary(regression_model_18)$adj.r.squared, 
          summary(regression_model_19)$adj.r.squared, 
          summary(regression_model_20)$adj.r.squared, 
          summary(regression_model_21)$adj.r.squared, 
          summary(regression_model_22)$adj.r.squared, 
          summary(regression_model_23)$adj.r.squared, 
          summary(regression_model_24)$adj.r.squared, 
          summary(regression_model_25)$adj.r.squared, 
          summary(regression_model_26)$adj.r.squared, 
          summary(regression_model_27)$adj.r.squared, 
          summary(regression_model_28)$adj.r.squared, 
          summary(regression_model_29)$adj.r.squared, 
          summary(regression_model_30)$adj.r.squared, 
          summary(regression_model_31)$adj.r.squared, 
          summary(regression_model_32)$adj.r.squared,
          summary(regression_model_33)$adj.r.squared, 
          summary(regression_model_34)$adj.r.squared, 
          summary(regression_model_35)$adj.r.squared, 
          summary(regression_model_36)$adj.r.squared, 
          summary(regression_model_37)$adj.r.squared, 
          summary(regression_model_38)$adj.r.squared, 
          summary(regression_model_39)$adj.r.squared, 
          summary(regression_model_40)$adj.r.squared, 
          summary(regression_model_41)$adj.r.squared, 
          summary(regression_model_42)$adj.r.squared, 
          summary(regression_model_43)$adj.r.squared, 
          summary(regression_model_44)$adj.r.squared, 
          summary(regression_model_45)$adj.r.squared, 
          summary(regression_model_46)$adj.r.squared, 
          summary(regression_model_47)$adj.r.squared, 
          summary(regression_model_48)$adj.r.squared,
          summary(regression_model_49)$adj.r.squared, 
          summary(regression_model_50)$adj.r.squared, 
          summary(regression_model_51)$adj.r.squared, 
          summary(regression_model_52)$adj.r.squared, 
          summary(regression_model_53)$adj.r.squared, 
          summary(regression_model_54)$adj.r.squared, 
          summary(regression_model_55)$adj.r.squared, 
          summary(regression_model_56)$adj.r.squared, 
          summary(regression_model_57)$adj.r.squared, 
          summary(regression_model_58)$adj.r.squared, 
          summary(regression_model_59)$adj.r.squared, 
          summary(regression_model_60)$adj.r.squared, 
          summary(regression_model_61)$adj.r.squared, 
          summary(regression_model_62)$adj.r.squared, 
          summary(maximum_regression_model)$adj.r.squared)

model_name <- c("regression_model_1",
                  "regression_model_2",
                  "regression_model_3",
                  "regression_model_4",
                  "regression_model_5",
                  "regression_model_6",
                  "regression_model_7",
                  "regression_model_8",
                  "regression_model_9",
                  "regression_model_10",
                  "regression_model_11",
                  "regression_model_12",
                  "regression_model_13",
                  "regression_model_14",
                  "regression_model_15",
                  "regression_model_16",
                  "regression_model_17",
                  "regression_model_18",
                  "regression_model_19",
                  "regression_model_20",
                  "regression_model_21",
                  "regression_model_22",
                  "regression_model_23",
                  "regression_model_24",
                  "regression_model_25",
                  "regression_model_26",
                  "regression_model_27",
                  "regression_model_28",
                  "regression_model_29",
                  "regression_model_30",
                  "regression_model_31",
                  "regression_model_32",
                  "regression_model_33",
                  "regression_model_34",
                  "regression_model_35",
                  "regression_model_36",
                  "regression_model_37",
                  "regression_model_38",
                  "regression_model_39",
                  "regression_model_40",
                  "regression_model_41",
                  "regression_model_42",
                  "regression_model_43",
                  "regression_model_44",
                  "regression_model_45",
                  "regression_model_46",
                  "regression_model_47",
                  "regression_model_48",
                  "regression_model_49",
                  "regression_model_50",
                  "regression_model_51",
                  "regression_model_52",
                  "regression_model_53",
                  "regression_model_54",
                  "regression_model_55",
                  "regression_model_56",
                  "regression_model_57",
                  "regression_model_58",
                  "regression_model_59",
                  "regression_model_60",
                  "regression_model_61",
                  "regression_model_62",
                  "regression_model_63")

final <- data.frame(model_name, r_squared)

final_model <- final |>
  filter(r_squared == max(r_squared))
```

Using reproducible R code, we were able to find the regression model
with the highest adjusted R-squared. This model (`regression_model_61`)
has an adjusted r-squared of `r max(final$r_squared)` . It implements
the predictors of `family_poverty` , `ratio_of_one_to_both`,
`average_center_child_care`, `average_family_child_care`, and
`one_parent_households`. Here is the tidy output of this model:

```{r}
#| label: model-tidy-output

tidy(regression_model_61)
```

```{r}
#| label: preparing-data-for-vis-4

#Preparing data
best_states_data <- merged_data_2018 |> 
  arrange(desc(MN)) |>
  mutate(achievement_level = if_else(MN>=223, "High", "Low")) |>
  filter(achievement_level == "High")

best_states_data <- best_states_data |>
  relocate(state_name) |> 
  pivot_longer(
    cols = c("emp_m", "emp_service", "emp_sales", "emp_n", "emp_p"), 
    names_to = "sector_type", 
    values_to = "sector_percentage"
  ) |>
  mutate(sector_type = case_when(
    sector_type == "emp_m" ~ "Management and Science", 
    sector_type == "emp_n" ~ "Natural Resources", 
    sector_type == "emp_p" ~ "Production", 
    sector_type == "emp_service" ~ "Public Service",
    sector_type == "emp_sales" ~ "Sales and Office"
    ), 
    state_name = case_when(
      state_name == "Massachusetts" ~ "MA", 
      state_name == "New Hampshire" ~ "NH",
      state_name == "New Jersey" ~ "NJ",
      state_name == "Wyoming" ~ "WY"
    )
  )

#Grouping and summarizing data 
summarized_data <- best_states_data |>
  group_by(state_name, sector_type) |>
  summarize(mean_percentage = mean(sector_percentage))


#Trying somethign new
summarized_data_1 <- best_states_data |>
  group_by(county_fips_code, study_year) |>
  summarize(sum_percentage = sum(sector_percentage))

summarized_data_2 <- best_states_data |>
  group_by(state_name, sector_type, study_year) |>
  summarize(mean_percentage = mean(sector_percentage))
  
#Merging data 
merged_intermediary_data <- left_join(best_states_data, summarized_data_1, join_by(county_fips_code, study_year))

merged_final_data <- left_join(merged_intermediary_data, summarized_data_2, join_by(state_name, sector_type, study_year))
```

```{r}
#| label: visualizing-states
#| fig-asp: 0.6

#Creating visualization
ggplot(summarized_data, aes(x = state_name, y = mean_percentage, fill = sector_type)) + 
  geom_bar(stat = "identity") + 
  scale_fill_viridis_d(option = "G") +
  theme_bw() + 
  labs(title = "Breakdown of Workplace Sectors \n by Proportion of State Population", x = "State", y = "Percentage of Population", fill = "Sector")

#Trying something new 
merged_final_data |> 
  filter(state_name == "Massachusetts") |>
  ggplot(aes(x = study_year, y = sum_percentage, fill = mean_percentage, color = sector_type)) + 
  geom_density(stat = "identity") 

```

# Write-Up

**Introductory Context**

The FOCUS cluster, Knowledge in the Service of Society, affectionately
dubbed KISS, is an educational program that empowers students with
interdisciplinary skills towards to effect social change at granular and
broad levels. One salient learning objective of the program is to
instill passion and knowledge for remedying injustices in our nation's
educational institutions. In this project, we seek to carry forward what
we have learned in our FOCUS and, through critical thinking, novel
understandings of data visualization, and empathy, highlight
discrepancies in academic achievement. Specifically, we will narrow in
on elementary school students across the United States, identifying
environmental factors that contribute to inequities in their education. 

**Goals:**

Particularly, the goals of our project are to 1) illustrate the relative
average 4th-grade reading level in each state; 2) provide a side-by-side
comparison of how much funding each state is allocating towards students
relative to each other; 3) utilize predictor pruning methods to
construct a linear regression model with community-level factors that
are associated with the average 4th-grade reading level across the
county; and 4) determine the distribution of adults across various
occupational fields in states with the best and worst 4th-grade reading
levels. Each goal corresponds to a visualization or regression model. 

**Data Overview:**

To achieve objectives, we integrated data from four datasets. The first
dataset was `scores`, which had `r ncol(scores)` variables and
`r nrow(scores)` observations. The variables of interest were
`state_name`, and `reading_level`, the average 4th-grade reading level
in the given state in 2022 (state-wide achievement level). The second
was `childcare_costs`, which had `r ncol(childcare_costs)` variables and
`r nrow(childcare_costs)` observations. `Childcare_costs` offered all of
our data on county-level socioeconomic factors, and we mutated various
variables to be potential predictors in our linear regression model for
goal #3. The `counties` dataset had `r ncol(counties)` variables and
`r nrow(counties)` observations and was used to merge the country-based
data in `childcare_costs` with the state-based data in `scores`. The
`expenditures` dataset had `r ncol(expenditures)` variables and
`r nrow(expenditures)` observations. From this dataset, we were
interested in examining `inf_adj_perchild`, or total government spending
on educational resources per child adjusted for inflation. 

The `scores` data are from 2022, while the `childcare_costs` and
`expenditures` data are from 2018 and 2016, respectively. We thought
this was acceptable in the context because it is realistic for there to
be a years-long delay between changes in community funding and resources
and subsequent academic improvements.

**Findings:**

Visualization #1 achieves goal #1 through a choropleth map, which is a
map that leverages differences in shading to denote the average value of
a variable in distinct geographic regions. We primarily employ the
`geom_polygon()` tool to do so. The map illustrates that three states,
Florida, Wyoming, and Massachusetts, stood out among the rest for having
superior demonstrated 4th-grade reading levels. To zoom out from this
superlative factoid, it is also the case that smaller northeastern and a
few midwestern states have higher reading levels It may seem arbitrary
that these three states scored above the rest in terms of reading
levels, especially considering the diverse areas of the United States in
which each of them is situated. However, consideration of principles
learned in the KISS class, Critical Race Theory in Education, proves
otherwise. Research into the breakdown of Florida's 4th grade reading
levels reveals one interesting notion: White students demonstrated
consistently high reading levels, second only to Asian students (who
make up a significant minority of the elementary population), whereas
their other non-White counterparts scored lower, on average ("The
Nation's..."). Considering prior knowledge, the makeup of smaller
northeastern states like Massachusetts or New Jersey and midwestern
states like Wyoming or Colorado is also noteworthily White. Discussions
in CRT have revealed the unfortunate truth that America's education
systems are upheld to be conducive to White students. According to the
class-provided article "School Norms and Reforms, Critical Race Theory,
and the Fairytale of Equitable Education," White students excel on
aptitude assessments like the SAT or IQ tests because they have been
designed for them to do so. So, while there may be noteworthy additional
circumstances that foretell academic success, as we begin analyzing
predictors of achievement, it is important to first recognize race's
interplay with soon-to-be considered factors in propelling a certain
demographic forward within American school systems. 

Visualization #2 fulfills goal #2 through another choropleth map. This
time, each state is shaded based on its `inf_adj_perchild`. A
side-by-side comparison of visualization #1 and #2 allows for
preliminary conclusions on the impact of public investments into youth
education and enables us to start identifying states that may have
particularly cost-effective educational systems. New York, New Jersey,
and Wyoming come forward as the states with the highest government
spending on students. This has broad ties to visualization #1 where New
Jersey and Wyoming were both in the top 5 of states in terms of
`reading_level.` Notably, New York was ranked as state #37 in terms of
`reading_level`, raising questions worth exploring in future research
about how New York is investing in public education.

Our `final_model` addresses goal #3. A foundational literature review
implicates several social, psychological, and economic in the
development of reading skills in elementary schoolers. Socioeconomic
status has been consistently shown to influence academic success,
specifically due to differing access to books, supportive services, and
qualified teachers as well as due to exposure to adversity and parental
distress. The structural connections between race, socioecnomic status,
and long-term outcomes makes racial minority status another potential
variable of interest. Along with socioeconomic status, parents' capacity
to be highly engaged and sincerely warm affects psychological health,
which often underpins academic trajectories. Thus, we seek to examine
whether having both, one, or no working parents affects reading skills.
Finally, it is necessary to explore the role of access to both
family-based and center-based child care given the proven significance
of high-quality child care. We cross-reference these findings with our
data to create a number of variables of interest. We constructed
`family_poverty`, which was renamed from `pr_f` and gives the poverty
rate in the given county and `minority_racial_status`, which is the
percent of the county population that identifies as one minority racial
identity or as biracial. We also developed `percentage_single_mother`,
which is the number of households with single mothers, divided by the
total number of `households`. We designed another variable for the ratio
of households with one working parent to two working parents:
`ratio_of_one_to_both`. By simply renaming, we created
`average_center_child_care` and `average_family_child_care`, the average
cost of center-based and family-based child care, respectively, in the
given county. We first engineered a maximum additive regression model
with all the possible predictors, and then, we manually performed
forward selection to determine what combination of the predictors
yielded a model with the lowest adjusted R2. The models were sorted
based on adjusted-R2. We created a data frame with all of the models and
their corresponding adjusted R2 values. We then filtered for the model
with the maximum R2. We find that `regression_model_61` has the best fit
and it includes the predictors `family_poverty` ,
`ratio_of_one_to_both`, `average_center_child_care`,
`average_family_child_care`, and `one_parent_households`.

Visualization #4 is rooted in goal #4. We have always been committed to
creating a visualization that zooms in on states with the highest values
in `reading_level`. In our literature review to determine potential
community-level predictors for `reading_level`, we found that both
socioeconomic status and parental attitudes contribute to
`reading_level`, both of which may be reflect in parents' occupations.
Thus, we opted to explore the average distribution of occupational
fields of adults across all the counties in Massachusetts, New Jersey,
New Hampshire, and Wyoming, the states with the highest `reading_level`
scores with inputted data for occupational percentages in
`childcare_costs` in 2018--- the most recent year of data collection.
The original dataset included each occupational field as a separate
variable and gave the percentage of adults who worked in that field for
each county. We then pivoted the data so that each there was one
variable for the names of the occupational fields, `sector_type`, and
the associated percentage in each occupational field,
`sector_percentage`. This enabled us to construct a bar graph that
depicted the average percentage of the population that worked in each
sector in each state. We find that in all four states of highest
`reading_level`, the highest percentage of the population was employed
in "Management and Science." To go about explaining the distribution
represented in this visualization, we drew upon the skill developed in
the Rethinking Schools class: self-reflection. As we each examined the
industries present in our hometowns, it becomes clear why there is a
correlation between higher achievement and a high management and science
makeup. In Noah's hometown of Fairfax, Virginia, there is a large
presence of government consulting firms and technology startups. He
recalls how the confluence of these industries catalyzed his school
district to become among the largest in the nation and found a magnet
STEM school, Thomas Jefferson HS, now ranked the fifth best high school
in the nation. Another testament to this notion is how Anushka, being
from Westchester, New York, grew up surrounded by leaders of finance,
medicine, and technology companies--no doubt making her school district
(the 13th best in the country) what it is. Reflecting on some of our
personal upbringings ultimately speaks to the data-driven fact that high
achievement is associated with specific industry, making this
visualization both personally and mathematically impactful.

**Conclusion:**\
Overall, our conclusions illuminate opportunities for political and
programmatic interventions. Visualization #1 identifies the states with
the highest scores in 4th-grade reading to be Massachusetts, Florida,
and Wyoming. We subsequently determine that White students are
overrepresented in these best-practice states. There is then a need to
ensure that school's do not exclusively appeal to the intellectual and
social tendencies associated with Whiteness. Future research should be
conducted to test the efficacy and feasibility of nascent frameworks for
multicultural education. Visualization #2 finds that New Jersey, New
York, and Wyoming have the highest expenditures on students. More
specific work needs to be done on the associations between
`inf_adj_perchild` and `reading_level`. Visualization #3 finds that
`family_poverty` , `ratio_of_one_to_both`, `average_center_child_care`,
`average_family_child_care`, and `one_parent_households` all play a
significant role in children's educational experiences. Immediately,
this analysis supports the continued development of public policies that
encourage maternity and/or paternity leave as well as fund subsidized
childcare programs. Furthermore, we affirm an already robust
understanding of the poverty cycle; low educational achievement
associated with high poverty levels will make it tough for children from
low-income neighborhoods to reach economic prosperity. Visualization #4
suggests that states with high `reading_level` also have a high
percentage of adults who work in "Management and Science," fostering
ideas about novel programs that create government-sponsored vocational
training for adults from all communities to enter competitive fields.

Our analyses were restricted in a number of ways. First, since we only
had the average 4th-grade `reading_level` per state, we were not able to
take comprehensive advantage of the detailed data at the county level.
We could only look at the heterogeneity between states rather than the
heterogeneity within states as well. Also, we could not examine
longitudinal trends; we only had scores from 2022, so we opted to use
community data from 2018, the most recent year of inputted data in
`childcare_costs`, thus producing an arbitrary inference concerning
time-delay. Moreover, in the field of childhood education, standardized
tests have persistently been delegitimized as they are not truly
baseline ways to measure aptitude, potential, and achievement when other
confounding variables such as disability or neurodiversity exist as we
learned in our other FOCUS classes. In light of these limitations,
future research should determine predictors of academic success at the
county level, which will facilitate more specific conclusions and data
points that can be used in the training of regression models.
Additionally, interactive visualizations can be pioneered to represent
changes in `reading_level` and corresponding predictors over time.
Research effort should also be made to replicate these analyses but with
a more holistic outcome measure, such as overall classroom functioning
as reported by teachers.
